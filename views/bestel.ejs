<%- include('partials/header') %>

<main>
  <section class="menu">
    <h1 id="ons_menu">Ons Menu</h1>
    <section id="bestsellers">
      <div class="listItem">
        <% pizzas.forEach(pizza => {%>
        <article class="card">
          <img
            src="assets/images/pizza_images/<%= pizza.image %>"
            alt="<%= pizza.name %>"
          />
          <h1 class="pizzaNaam"><%= pizza.name %></h1>
          <form action="/bestel" method="POST">
            <span class="pizzaPrice" style="font-size: 1rem"
              >Vanaf â‚¬<%= pizza.price.toFixed(2) %></span
            >
            <input type="hidden" name="amount" value="1" />
            <input type="hidden" name="pizza" value="<%= pizza.name %>" />
            <input type="hidden" name="price" value="<%= pizza.price %>" />
            <input type="hidden" name="image" value="<%= pizza.image %>" />
            <button type="submit" class="orderbutton">+</button>
          </form>
        </article>
        <% }); %>
      </div>
    </section>
  </section>

  <aside>
    <button class="close-aside">Ã—</button>
    <div>
      <h1>Uw Bestelling</h1>
      <ul class="order-list">
        <% cart.items.forEach(item => { %>
        <li>
          <div class="pizzalist">
            <!-- Eerste lijn: naam en prijs -->
            <div class="pizza-header">
              <h2><%= item.name %></h2>
              <p>â‚¬<%= item.price %></p>
            </div>
            
            <!-- Tweede lijn: aantal en verwijderknop -->
            <div class="pizza-controls">
              <form action="/bestel/update" method="POST" style="display:inline">
                <input type="hidden" name="item" value="<%= item.name %>" />
                <label>
                  Aantal:
                  <select name="amount" onchange="this.form.submit()">
                    <% for (let i = 1; i <= Math.max(10, item.amount); i++) { %>
                      <option value="<%= i %>" <%= item.amount === i ? "selected" : "" %>>
                        <%= i %>
                      </option>
                    <% } %>
                  </select>
                </label>
              </form>
              
              <form action="/bestel/verwijder" method="POST" style="display: inline">
                <input type="hidden" name="item" value="<%= item.name %>" />
                <button
                  type="submit"
                  class="remove-button"
                  aria-label="Verwijder bestelling"
                >
                  Verwijder
                </button>
              </form>
            </div>
          </div>
        </li>
        <% }); %>
      </ul>
    </div>

    <div id="afrekenen">
      <div class="total">
        <h2>Totaal: â‚¬<%= cart.totalPrice.toFixed(2) %></h2>
      </div>
      <form action="/checkout">
        <input
          type="hidden"
          name="image"
          value="<%= cart.totalPrice.toFixed %>"
        />
        <button type="submit" class="bestelButton">Bestellen</button>
      </form>
    </div>
  </aside>

  <button class="aside-toggle">
    ðŸ›’
    <span class="cart-count"><%= totalAmountCartItems(cart) %></span>
  </button>
  <div class="aside-overlay"></div>
</main>

<%- include('partials/footer') %>