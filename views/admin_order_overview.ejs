<%- include('partials/header') %>
<main>
  <h1>Bestellingsoverzicht:</h1>

  <% if (orders && orders.length === 0) { %>
    <p>Er zijn nog geen bestellingen.</p>
  <% } else { %>
    <section class="orderOverview">
      <ul class="orderList">
        <% orders.forEach(order => { %>
          <% 
            let total = 0; 
            order.items.forEach(item => { 
              total += item.price * item.amount;
            }); 
          %>
          <li class="order">
            <div class="order-header">
              <span class="order-id">Bestelling #<%= order._id.toString().slice(-6) %></span>
              <span class="order-date"><%= order.formattedDate %></span>
            </div>
            
            <div class="customer-info">
              <strong>Klant:</strong> 
              <span class="user-name"><%= order.userName %></span>
              <% if (order.userEmail) { %>
                <br><small>Email: <%= order.userEmail %></small>
              <% } %>
              <% if (order.userPhone) { %>
                <br><small>Tel: <%= order.userPhone %></small>
              <% } %>
            </div>
            
            <ul class="pizza-list">
              <% order.items.forEach(item => { %>
                <li class="pizza-item">
                  <span class="pizza-name"><%= item.name %></span>
                  <span class="pizza-amount"><%= item.amount %>x</span>
                  <span class="pizza-price"><%= (item.price * item.amount).toFixed(2) %> €</span>
                </li>
              <% }) %>
            </ul>
            
            <div class="order-footer">
              <span class="order-total">Totaal: <%= order.formattedTotal %> €</span>
              <% if (order.paymentId) { %>
                <br><small class="payment-id">Stripe ID: <%= order.paymentId.slice(-8) %></small>
              <% } %>
            </div>
          </li>
        <% }) %>
      </ul>
    </section>
  <% } %>
</main>

<%- include('partials/footer') %>